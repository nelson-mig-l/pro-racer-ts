(self.webpackChunkpro_racer=self.webpackChunkpro_racer||[]).push([[719,976,403],{7594:(e,t,s)=>{"use strict";s.d(t,{H:()=>h,u:()=>a});var i=s(216);let h;const a=new Promise((e=>{(new i).then((t=>{h=t,e(t)}))}))},5575:(e,t,s)=>{"use strict";s.r(t),s.d(t,{Boxes:()=>n});var i=s(3242),h=s(7417),a=s(9823),r=s(9635);class n{constructor(e){this.scene=e,this.redMaterial=new i.K("RedMaterial",e),this.redMaterial.diffuseColor=new h.Wo(.8,.4,.5),this.redMaterial.emissiveColor=new h.Wo(.8,.4,.5),this.blueMaterial=new i.K("BlueMaterial",e),this.blueMaterial.diffuseColor=new h.Wo(.5,.4,.8),this.blueMaterial.emissiveColor=new h.Wo(.5,.4,.8)}baseBoxes(){this.createBox(new h.P(4,1,12),new h.P(0,0,25),new h.P(-Math.PI/8,0,0),0),this.createBox(new h.P(4,1,12),new h.P(25,0,0),new h.P(-Math.PI/8,Math.PI/2,0),0),this.createBox(new h.P(4,1,12),new h.P(0,0,-25),new h.P(Math.PI/8,0,0),0),this.createBox(new h.P(4,1,12),new h.P(-25,0,0),new h.P(Math.PI/8,Math.PI/2,0),0)}randomBoxes(){const e=new h.P,t=new h.P,s=new h.P;for(let i=0;i<20;i++){const i=300*Math.random()-150+5,h=300*Math.random()-150+5,a=10*Math.random();e.set(a,a,a),t.set(h,0,i),s.set(i,i,i),this.createBox(e,t,s,0)}for(let i=0;i<30;i++){const i=300*Math.random()-150+5,h=300*Math.random()-150+5,a=3*Math.random();e.set(a,a,a),t.set(h,0,i),s.set(i,i,i),this.createBox(e,t,s,5)}}createBox(e,t,s,i){const h=a.V.CreateBox("box",{width:e.x,depth:e.z,height:e.y},this.scene);return h.position.set(t.x,t.y,t.z),h.rotation.set(s.x,s.y,s.z),i?(h.position.y+=5,h.material=this.blueMaterial):(i=0,h.material=this.redMaterial),h.physicsImpostor=new r.Q(h,r.Q.BoxImpostor,{mass:i,friction:.5,restitution:.7},this.scene),h}}},9976:(e,t,s)=>{"use strict";s.r(t),s.d(t,{Car:()=>n});var i=s(7057),h=s(9121),a=s(7417),r=s(9823);class n{constructor(e,t,s){this.ZERO_QUATERNION=new a._f,this.FRONT_LEFT=0,this.FRONT_RIGHT=1,this.BACK_LEFT=2,this.BACK_RIGHT=3,this.chassisWidth=1.8,this.chassisHeight=.6,this.chassisLength=4,this.massVehicle=200,this.wheelAxisPositionBack=-1,this.wheelRadiusBack=.4,this.wheelWidthBack=.3,this.wheelHalfTrackBack=1,this.wheelAxisHeightBack=.4,this.wheelAxisFrontPosition=1,this.wheelHalfTrackFront=1,this.wheelAxisHeightFront=.4,this.wheelRadiusFront=.4,this.wheelWidthFront=.3,this.friction=5,this.suspension={stiffness:10,damping:.3,compression:4.4,restLength:.6},this.rollInfluence=0,this.steeringIncrement=.01,this.steeringClamp=.2,this.maxEngineForce=500,this.maxBreakingForce=10,this.incEngine=10,this.vehicleSteering=0,this.engineForce=0,this.breakingForce=0,this.wheelMeshes=[],this.vehicleReady=!1,this.greenMaterial=new i.StandardMaterial("GreenMaterial",t),this.greenMaterial.diffuseColor=new a.Wo(.5,.8,.5),this.greenMaterial.emissiveColor=new a.Wo(.5,.8,.5),this.blackMaterial=new i.StandardMaterial("BlackMaterial",t),this.blackMaterial.diffuseColor=new a.Wo(.1,.1,.1),this.blackMaterial.emissiveColor=new a.Wo(.1,.1,.1),this.scene=t;const h=t.getPhysicsEngine()?.getPhysicsPlugin().world;this.wheelDirectionCS0=new s.btVector3(0,-1,0),this.wheelAxleCS=new s.btVector3(-1,0,0);const r=new s.btBoxShape(new s.btVector3(.5*this.chassisWidth,.5*this.chassisHeight,.5*this.chassisLength)),n=new s.btTransform;n.setIdentity(),n.setOrigin(new s.btVector3(0,5,0)),n.setRotation(new s.btQuaternion(this.ZERO_QUATERNION.x,this.ZERO_QUATERNION.y,this.ZERO_QUATERNION.z,this.ZERO_QUATERNION.w));const o=new s.btDefaultMotionState(n),c=new s.btVector3(0,0,0);r.calculateLocalInertia(this.massVehicle,c),this.chassisMesh=this.createChassisMesh(this.chassisWidth,this.chassisHeight,this.chassisLength);const l=new s.btVector3(0,.4,0),w=new s.btTransform;w.setIdentity(),w.setOrigin(l);const d=new s.btCompoundShape;d.addChildShape(w,r);const g=new s.btRigidBody(new s.btRigidBodyConstructionInfo(this.massVehicle,o,d,c));g.setActivationState(4),h.addRigidBody(g),this.tuning=new s.btVehicleTuning;const u=new s.btDefaultVehicleRaycaster(h);this.vehicle=new s.btRaycastVehicle(this.tuning,g,u),this.vehicle.setCoordinateSystem(0,1,2),h.addAction(this.vehicle),this.vehicle.getChassisWorldTransform(),this.addWheel(!0,new s.btVector3(this.wheelHalfTrackFront,this.wheelAxisHeightFront,this.wheelAxisFrontPosition),this.wheelRadiusFront,this.wheelWidthFront,this.FRONT_LEFT),this.addWheel(!0,new s.btVector3(-this.wheelHalfTrackFront,this.wheelAxisHeightFront,this.wheelAxisFrontPosition),this.wheelRadiusFront,this.wheelWidthFront,this.FRONT_RIGHT),this.addWheel(!1,new s.btVector3(-this.wheelHalfTrackBack,this.wheelAxisHeightBack,this.wheelAxisPositionBack),this.wheelRadiusBack,this.wheelWidthBack,this.BACK_LEFT),this.addWheel(!1,new s.btVector3(this.wheelHalfTrackBack,this.wheelAxisHeightBack,this.wheelAxisPositionBack),this.wheelRadiusBack,this.wheelWidthBack,this.BACK_RIGHT),this.vehicleReady=!0}createChassisMesh(e,t,s){const i=r.V.CreateBox("box",{width:e,depth:s,height:t},this.scene);i.rotationQuaternion=new a._f,i.material=this.greenMaterial;const n=new h.i("FollowCam",new a.P(0,10,-10),this.scene);return n.radius=10,n.heightOffset=4,n.rotationOffset=0,n.cameraAcceleration=.05,n.maxCameraSpeed=400,n.attachControl(!0),n.lockedTarget=i,this.scene.activeCamera=n,i}addWheel(e,t,s,i,h){const a=this.vehicle.addWheel(t,this.wheelDirectionCS0,this.wheelAxleCS,this.suspension.restLength,s,this.tuning,e);a.set_m_suspensionStiffness(this.suspension.stiffness),a.set_m_wheelsDampingRelaxation(this.suspension.damping),a.set_m_wheelsDampingCompression(this.suspension.compression),a.set_m_maxSuspensionForce(6e5),a.set_m_frictionSlip(40),a.set_m_rollInfluence(this.rollInfluence),this.wheelMeshes[h]=this.createWheelMesh(s,i)}createWheelMesh(e,t){const s=r.V.CreateCylinder("Wheel",{diameter:2*e,height:t,tessellation:6},this.scene);return s.rotationQuaternion=new a._f,s.material=this.blackMaterial,s}}},8403:(e,t,s)=>{"use strict";s.r(t),s.d(t,{Controls:()=>r});var i=s(7417);const h=new Map([["acceleration",!1],["braking",!1],["right",!1],["left",!1],["reset",!1]]),a=new Map([["KeyW","acceleration"],["KeyS","braking"],["KeyA","left"],["KeyD","right"],["KeyR","reset"]]);class r{constructor(e){this.car=e,window.addEventListener("keydown",this.keydown),window.addEventListener("keyup",this.keyup)}update(){if(this.car.vehicleReady){const e=this.car.vehicle.getCurrentSpeedKmHour();let t,s,a,r;this.car.breakingForce=0,this.car.engineForce=0,h.get("reset")&&(this.car.chassisMesh.position.set(0,5,0),console.log("reset")),h.get("acceleration")?e<-1?this.car.breakingForce=this.car.maxBreakingForce:this.car.engineForce=this.car.maxEngineForce:h.get("braking")&&(e>1?this.car.breakingForce=this.car.maxBreakingForce:this.car.engineForce=-this.car.maxEngineForce),h.get("right")?this.car.vehicleSteering<this.car.steeringClamp&&(this.car.vehicleSteering+=this.car.steeringIncrement):h.get("left")?this.car.vehicleSteering>-this.car.steeringClamp&&(this.car.vehicleSteering-=this.car.steeringIncrement):this.car.vehicleSteering=0,this.car.vehicle.applyEngineForce(this.car.engineForce,this.car.FRONT_LEFT),this.car.vehicle.applyEngineForce(this.car.engineForce,this.car.FRONT_RIGHT),this.car.vehicle.setBrake(this.car.breakingForce/2,this.car.FRONT_LEFT),this.car.vehicle.setBrake(this.car.breakingForce/2,this.car.FRONT_RIGHT),this.car.vehicle.setBrake(this.car.breakingForce,this.car.BACK_LEFT),this.car.vehicle.setBrake(this.car.breakingForce,this.car.BACK_RIGHT),this.car.vehicle.setSteeringValue(this.car.vehicleSteering,this.car.FRONT_LEFT),this.car.vehicle.setSteeringValue(this.car.vehicleSteering,this.car.FRONT_RIGHT);const n=this.car.vehicle.getNumWheels();for(r=0;r<n;r++)this.car.vehicle.updateWheelTransform(r,!0),t=this.car.vehicle.getWheelTransformWS(r),s=t.getOrigin(),a=t.getRotation(),this.car.wheelMeshes[r].position.set(s.x(),s.y(),s.z()),this.car.wheelMeshes[r].rotationQuaternion?.set(a.x(),a.y(),a.z(),a.w()),this.car.wheelMeshes[r].rotate(i.RD.Z,Math.PI/2);t=this.car.vehicle.getChassisWorldTransform(),s=t.getOrigin(),a=t.getRotation(),this.car.chassisMesh.position.set(s.x(),s.y(),s.z()),this.car.chassisMesh.rotationQuaternion?.set(a.x(),a.y(),a.z(),a.w()),this.car.chassisMesh.rotate(i.RD.X,Math.PI)}}keyup(e){a.get(e.code)&&h.set(a.get(e.code)??"",!1)}keydown(e){a.get(e.code)&&h.set(a.get(e.code)??"",!0)}}},7357:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>F});var i=s(4147),h=s(156),a=s(972),r=s(5348),n=s(7759),o=(s(703),s(3242)),c=s(9635),l=s(7594),w=s(9823),d=s(7417),g=s(5575),u=s(9976),m=s(8403),f=s(1552),p=s(4684);const F=new class{constructor(){this.preTasks=[l.u],this.createScene=async(e,t)=>{const s=new i.x(e),F=new h.c("camera1",new a.P(0,5,-10),s);F.setTarget(a.P.Zero()),F.attachControl(t,!0),new r.e("light",new a.P(0,1,0),s).intensity=.7;const k=new o.K("RedMaterial",s);k.diffuseColor=new d.Wo(.8,.4,.5),k.emissiveColor=new d.Wo(.8,.4,.5),s.enablePhysics(new a.P(0,-10,0),new n.b(!0,l.H));const x=w.V.CreateGround("ground",{width:460,height:460,subdivisions:2},s);x.physicsImpostor=new c.Q(x,c.Q.BoxImpostor,{mass:0,friction:.5,restitution:.7},s);const M=new o.K("ground material",s);M.diffuseTexture=new p.x(f.Z,s),x.material=M;const B=new g.Boxes(s);B.baseBoxes(),B.randomBoxes();const R=new u.Car(new a.P(0,4,-20),s,l.H),b=new m.Controls(R);return s.registerBeforeRender((function(){e.getDeltaTime(),b.update()})),s}}}},1552:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});const i=s.p+"9b31293ea96c8dfa518b45622da82a13.jpg"},4207:()=>{},297:()=>{}}]);
//# sourceMappingURL=719.babylonBundle.js.map