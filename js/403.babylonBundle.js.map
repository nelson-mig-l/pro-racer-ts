{"version":3,"file":"js/403.babylonBundle.js","mappings":"kJAGA,MAAMA,EAAU,IAAIC,IAAqB,CACrC,CAAC,gBAAgB,GACjB,CAAC,WAAW,GACZ,CAAC,SAAS,GACV,CAAC,QAAQ,KASPC,EAAc,IAAID,IAAoB,CACxC,CAAC,OAAO,gBACR,CAAC,OAAO,WACR,CAAC,OAAO,QACR,CAAC,OAAO,WAGL,MAAME,EAITC,YAAYC,GACRC,KAAKD,IAAMA,EACXE,OAAOC,iBAAkB,UAAWF,KAAKG,SACzCF,OAAOC,iBAAkB,QAASF,KAAKI,MAC3C,CAEAC,SACI,GAAGL,KAAKD,IAAIO,aAAa,CAErB,MAAMC,EAAQP,KAAKD,IAAIS,QAAQC,wBA+C/B,IAAIC,EAAIC,EAAGC,EAAGC,EA7Cdb,KAAKD,IAAIe,cAAgB,EACzBd,KAAKD,IAAIgB,YAAc,EAGpBrB,EAAQsB,IAAI,gBACPT,GAAS,EACTP,KAAKD,IAAIe,cAAgBd,KAAKD,IAAIkB,iBAElCjB,KAAKD,IAAIgB,YAAcf,KAAKD,IAAImB,eAG9BxB,EAAQsB,IAAI,aACdT,EAAQ,EACRP,KAAKD,IAAIe,cAAgBd,KAAKD,IAAIkB,iBAElCjB,KAAKD,IAAIgB,aAAef,KAAKD,IAAImB,gBAItCxB,EAAQsB,IAAI,SACPhB,KAAKD,IAAIoB,gBAAkBnB,KAAKD,IAAIqB,gBACpCpB,KAAKD,IAAIoB,iBAAmBnB,KAAKD,IAAIsB,mBAGnC3B,EAAQsB,IAAI,QACdhB,KAAKD,IAAIoB,iBAAmBnB,KAAKD,IAAIqB,gBACrCpB,KAAKD,IAAIoB,iBAAmBnB,KAAKD,IAAIsB,mBAIzCrB,KAAKD,IAAIoB,gBAAkB,EAG/BnB,KAAKD,IAAIS,QAAQc,iBAAiBtB,KAAKD,IAAIgB,YAAaf,KAAKD,IAAIwB,YACjEvB,KAAKD,IAAIS,QAAQc,iBAAiBtB,KAAKD,IAAIgB,YAAaf,KAAKD,IAAIyB,aAEjExB,KAAKD,IAAIS,QAAQiB,SAASzB,KAAKD,IAAIe,cAAgB,EAAGd,KAAKD,IAAIwB,YAC/DvB,KAAKD,IAAIS,QAAQiB,SAASzB,KAAKD,IAAIe,cAAgB,EAAGd,KAAKD,IAAIyB,aAC/DxB,KAAKD,IAAIS,QAAQiB,SAASzB,KAAKD,IAAIe,cAAed,KAAKD,IAAI2B,WAC3D1B,KAAKD,IAAIS,QAAQiB,SAASzB,KAAKD,IAAIe,cAAed,KAAKD,IAAI4B,YAE3D3B,KAAKD,IAAIS,QAAQoB,iBAAiB5B,KAAKD,IAAIoB,gBAAiBnB,KAAKD,IAAIwB,YACrEvB,KAAKD,IAAIS,QAAQoB,iBAAiB5B,KAAKD,IAAIoB,gBAAiBnB,KAAKD,IAAIyB,aAIrE,MAAMK,EAAI7B,KAAKD,IAAIS,QAAQsB,eAC3B,IAAKjB,EAAI,EAAGA,EAAIgB,EAAGhB,IACfb,KAAKD,IAAIS,QAAQuB,qBAAqBlB,GAAG,GACzCH,EAAKV,KAAKD,IAAIS,QAAQwB,oBAAoBnB,GAC1CF,EAAID,EAAGuB,YACPrB,EAAIF,EAAGwB,cACPlC,KAAKD,IAAIoC,YAAYtB,GAAGuB,SAASC,IAAI1B,EAAE2B,IAAK3B,EAAE4B,IAAK5B,EAAE6B,KACrDxC,KAAKD,IAAIoC,YAAYtB,GAAG4B,oBAAoBJ,IAAIzB,EAAE0B,IAAK1B,EAAE2B,IAAK3B,EAAE4B,IAAK5B,EAAE8B,KACvE1C,KAAKD,IAAIoC,YAAYtB,GAAG8B,OAAO,OAAQC,KAAKC,GAAG,GAGnDnC,EAAKV,KAAKD,IAAIS,QAAQsC,2BACtBnC,EAAID,EAAGuB,YACPrB,EAAIF,EAAGwB,cACPlC,KAAKD,IAAIgD,YAAYX,SAASC,IAAI1B,EAAE2B,IAAK3B,EAAE4B,IAAK5B,EAAE6B,KAClDxC,KAAKD,IAAIgD,YAAYN,oBAAoBJ,IAAIzB,EAAE0B,IAAK1B,EAAE2B,IAAK3B,EAAE4B,IAAK5B,EAAE8B,KACpE1C,KAAKD,IAAIgD,YAAYJ,OAAO,OAAQC,KAAKC,G,CAGjD,CAEQzC,MAAM4C,GACPpD,EAAYoB,IAAIgC,EAAEC,OACjBvD,EAAQ2C,IAAIzC,EAAYoB,IAAIgC,EAAEC,OAAO,IAAI,EAMjD,CAEQ9C,QAAQ6C,GACTpD,EAAYoB,IAAIgC,EAAEC,OACjBvD,EAAQ2C,IAAIzC,EAAYoB,IAAIgC,EAAEC,OAAO,IAAI,EAMjD,E","sources":["webpack://pro-racer/./src/scenes/controls.ts"],"sourcesContent":["import { Axis } from \"@babylonjs/core/Maths/math\";\nimport { Car } from \"./car\";\n\nconst actions = new Map<string, boolean>([\n    [\"acceleration\", false],\n    [\"braking\", false],\n    [\"right\", false],\n    [\"left\", false]\n]);\n\n// const keysActions = {\n//     \"KeyW\":'acceleration',\n//     \"KeyS\":'braking',\n//     \"KeyA\":'left',\n//     \"KeyD\":'right'\n// };\nconst keysActions = new Map<string, string>([\n    [\"KeyW\",'acceleration'],\n    [\"KeyS\",'braking'],\n    [\"KeyA\",'left'],\n    [\"KeyD\",'right']\n]);\n\nexport class Controls {\n\n    car: Car;\n\n    constructor(car: Car) {\n        this.car = car;\n        window.addEventListener( 'keydown', this.keydown);\n        window.addEventListener( 'keyup', this.keyup);\n    }\n\n    update() {\n        if(this.car.vehicleReady){\n                  \n            const speed = this.car.vehicle.getCurrentSpeedKmHour();\n            const maxSteerVal = 0.2;\n            this.car.breakingForce = 0;\n            this.car.engineForce = 0;\n\n            \n            if(actions.get(\"acceleration\")){\n                if (speed < -1){\n                    this.car.breakingForce = this.car.maxBreakingForce;\n                }else {\n                    this.car.engineForce = this.car.maxEngineForce;\n                }\n                    \n            } else if(actions.get(\"braking\")){\n                if (speed > 1){\n                    this.car.breakingForce = this.car.maxBreakingForce;\n                }else {\n                    this.car.engineForce = -this.car.maxEngineForce ;\n                }\n            } \n                    \n            if(actions.get(\"right\")){\n                if (this.car.vehicleSteering < this.car.steeringClamp){\n                    this.car.vehicleSteering += this.car.steeringIncrement;\n                }\n                    \n            } else if(actions.get(\"left\")){\n                if (this.car.vehicleSteering > -this.car.steeringClamp){\n                    this.car.vehicleSteering -= this.car.steeringIncrement;\n                }\n                    \n            } else {\n                this.car.vehicleSteering = 0;\n            }\n                    \n            this.car.vehicle.applyEngineForce(this.car.engineForce, this.car.FRONT_LEFT);\n            this.car.vehicle.applyEngineForce(this.car.engineForce, this.car.FRONT_RIGHT);\n                    \n            this.car.vehicle.setBrake(this.car.breakingForce / 2, this.car.FRONT_LEFT);\n            this.car.vehicle.setBrake(this.car.breakingForce / 2, this.car.FRONT_RIGHT);\n            this.car.vehicle.setBrake(this.car.breakingForce, this.car.BACK_LEFT);\n            this.car.vehicle.setBrake(this.car.breakingForce, this.car.BACK_RIGHT);\n                    \n            this.car.vehicle.setSteeringValue(this.car.vehicleSteering, this.car.FRONT_LEFT);\n            this.car.vehicle.setSteeringValue(this.car.vehicleSteering, this.car.FRONT_RIGHT);\n                    \n                    \n            let tm, p, q, i;\n            const n = this.car.vehicle.getNumWheels();\n            for (i = 0; i < n; i++) {\n                this.car.vehicle.updateWheelTransform(i, true);\n                tm = this.car.vehicle.getWheelTransformWS(i);\n                p = tm.getOrigin();\n                q = tm.getRotation();\n                this.car.wheelMeshes[i].position.set(p.x(), p.y(), p.z());\n                this.car.wheelMeshes[i].rotationQuaternion?.set(q.x(), q.y(), q.z(), q.w());\n                this.car.wheelMeshes[i].rotate(Axis.Z, Math.PI/2);\n            }\n\n            tm = this.car.vehicle.getChassisWorldTransform();\n            p = tm.getOrigin();\n            q = tm.getRotation();\n            this.car.chassisMesh.position.set(p.x(), p.y(), p.z());\n            this.car.chassisMesh.rotationQuaternion?.set(q.x(), q.y(), q.z(), q.w());\n            this.car.chassisMesh.rotate(Axis.X, Math.PI);\n                 \n        }\n    }\n\n    private keyup(e: KeyboardEvent) {\n        if(keysActions.get(e.code)) {\n            actions.set(keysActions.get(e.code)??\"\", false);\n            //e.preventDefault();\n            //e.stopPropagation();\n\n            //return false;\n        }\n    }\n\n    private keydown(e: KeyboardEvent) {\n        if(keysActions.get(e.code)) {\n            actions.set(keysActions.get(e.code)??\"\", true);\n            //e.preventDefault();\n            //e.stopPropagation();\n\n            //return false;\n        }\n    }\n\n\n}\n"],"names":["actions","Map","keysActions","Controls","constructor","car","this","window","addEventListener","keydown","keyup","update","vehicleReady","speed","vehicle","getCurrentSpeedKmHour","tm","p","q","i","breakingForce","engineForce","get","maxBreakingForce","maxEngineForce","vehicleSteering","steeringClamp","steeringIncrement","applyEngineForce","FRONT_LEFT","FRONT_RIGHT","setBrake","BACK_LEFT","BACK_RIGHT","setSteeringValue","n","getNumWheels","updateWheelTransform","getWheelTransformWS","getOrigin","getRotation","wheelMeshes","position","set","x","y","z","rotationQuaternion","w","rotate","Math","PI","getChassisWorldTransform","chassisMesh","e","code"],"sourceRoot":""}